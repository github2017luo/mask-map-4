(function(t){function e(e){for(var s,o,n=e[0],l=e[1],c=e[2],u=0,p=[];u<n.length;u++)o=n[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],s=!0,n=1;n<a.length;n++){var l=a[n];0!==r[l]&&(s=!1)}s&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var s={},r={app:0},i=[];function o(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=s,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(a,s,function(e){return t[e]}.bind(null,s));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/mask-map/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid",attrs:{id:"app"}},[a("div",{staticClass:"row"},[a("nav",{staticClass:"navbar bg-secondary col-12"},[a("h1",{staticClass:"font-weight-bold text-white"},[t._v("口罩地圖")]),a("button",{staticClass:"btn btn-secondary d-flex",on:{click:function(e){return t.openModal("info")}}},[a("i",{staticClass:"far fa-question-circle text-white"})])]),a("div",{staticClass:"col-sm-6 mt-3"},[a("div",{staticClass:"form-group d-flex flex-column"},[a("button",{staticClass:"btn btn-primary",class:{disabled:!t.user.userStat},on:{click:t.flyToUser}},[t._v("搜尋附近藥局")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.select.city,expression:"select.city"}],staticClass:"form-control mt-2 border border-primary",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"city",e.target.multiple?a:a[0])},function(e){t.select.county=""}]}},[a("option",{attrs:{value:""}},[t._v("請選擇城市")]),t._l(t.allArea,(function(e){return a("option",{key:e.CityName,domProps:{value:e.CityName}},[t._v(t._s(e.CityName))])}))],2),t.select.city?a("select",{directives:[{name:"model",rawName:"v-model",value:t.select.county,expression:"select.county"}],staticClass:"form-control mt-2 border border-primary",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"county",e.target.multiple?a:a[0])},t.updateMap]}},[a("option",{attrs:{value:""}},[t._v("請選擇地區")]),t._l(t.allArea.find((function(e){return e.CityName===t.select.city})).AreaList,(function(e){return a("option",{key:e.AreaName,domProps:{value:e.AreaName}},[t._v(t._s(e.AreaName))])}))],2):t._e()]),t.stores.length?a("ul",{staticClass:"result result-pc list-group list-unstyled col-sm-12",staticStyle:{height:"500px",overflow:"scroll"}},[t._m(0),t._l(t.stores,(function(e,s){return a("li",{key:s,staticClass:"result-list d-flex p-2 shadow-sm rounded-lg mt-2",staticStyle:{"border-left":"7px solid #20c997"},on:{click:function(a){return a.preventDefault(),t.flyTo(e.geometry.coordinates,e)}}},[a("div",[a("h3",{staticClass:"mr-3",staticStyle:{display:"inline"}},[t._v(t._s(e.properties.name))]),e.properties.note.length>2?a("button",{on:{click:function(a){return t.openModal("note",e)}}},[t._v("註")]):t._e(),a("p",[t._v(t._s(e.properties.address))]),a("p",[t._v(t._s(e.properties.phone))]),a("small",[t._v("最後更新: "+t._s(e.properties.updated))])]),a("div",{staticClass:"d-flex ml-auto align-items-center col-6"},[a("div",{staticClass:"quantity qty-pad col-6 text-center rounded-left d-flex align-items-center",class:e.adultClass},[t._m(1,!0),a("div",[t._v(t._s(e.properties.mask_adult))])]),a("div",{staticClass:"quantity qty-pad col-6 text-center rounded-right d-flex align-items-center border-left border-white",class:e.childClass},[t._m(2,!0),a("div",[t._v(t._s(e.properties.mask_child))])])])])}))],2):t._e()]),t._m(3),t.stores.length?a("ul",{staticClass:"result result-mobile list-group list-unstyled col-sm-12",staticStyle:{height:"500px",overflow:"scroll"}},[t._m(4),t._l(t.stores,(function(e,s){return a("li",{key:s,staticClass:"result-list d-flex p-2 shadow-sm rounded-lg mt-2",staticStyle:{"border-left":"7px solid #20c997"},on:{click:function(a){return a.preventDefault(),t.flyTo(e.geometry.coordinates,e)}}},[a("div",[a("h3",{staticClass:"mr-3",staticStyle:{display:"inline"}},[t._v(t._s(e.properties.name))]),e.properties.note.length>2?a("button",{on:{click:function(a){return t.openModal("note",e)}}},[t._v("註")]):t._e(),a("p",[t._v(t._s(e.properties.address))]),a("p",[t._v(t._s(e.properties.phone))]),a("small",[t._v("最後更新: "+t._s(e.properties.updated))])]),a("div",{staticClass:"d-flex ml-auto align-items-center col-6"},[a("div",{staticClass:"quantity qty-pad col-6 text-center rounded-left d-flex align-items-center",class:e.adultClass},[t._m(5,!0),a("div",[t._v(t._s(e.properties.mask_adult))])]),a("div",{staticClass:"quantity qty-pad col-6 text-center rounded-right d-flex align-items-center border-left border-white",class:e.childClass},[t._m(6,!0),a("div",[t._v(t._s(e.properties.mask_child))])])])])}))],2):t._e()]),t._m(7),a("div",{staticClass:"modal fade",attrs:{id:"noteModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(8),a("div",{staticClass:"modal-body"},[t._v(t._s(t.note))])])])]),t._m(9)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"result-list d-flex p-2 shadow-sm rounded-lg mt-2",staticStyle:{"border-left":"7px solid #ffc107"}},[a("div",[t._v("可點選以下藥局並前往其所在位置")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon"},[a("i",{staticClass:"fas fa-male"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon"},[a("i",{staticClass:"fas fa-child"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-sm-6 p-3"},[a("div",{staticStyle:{height:"650px"},attrs:{id:"map"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"result-list d-flex p-2 shadow-sm rounded-lg mt-2",staticStyle:{"border-left":"7px solid #ffc107"}},[a("div",[t._v("可點選以下藥局並前往其所在位置")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon"},[a("i",{staticClass:"fas fa-male"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"icon"},[a("i",{staticClass:"fas fa-child"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"footer bg-secondary p-1 d-flex align-items-center"},[a("div",{staticClass:"footer-info text-white ml-3"},[a("span",{staticClass:"mr-1"},[t._v("防疫專線 1922 |")]),a("a",{staticClass:"mr-3 text-white",staticStyle:{"text-decoration":"none"},attrs:{href:"https://github.com/recafox/recafox.github.io.git"}},[a("i",{staticClass:"fab fa-github text-white"}),t._v(" Rita Ho ")]),a("a",{staticClass:"text-white mr-3",attrs:{href:"https://icons8.com/icon/97574/search"}},[t._v("Icons8")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("藥局備註")]),a("button",{staticClass:"close btn btn-danger",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade",attrs:{id:"infoModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("購買規定 (2020/02/18)")]),a("button",{staticClass:"close btn btn-danger",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),a("div",{staticClass:"modal-body"},[a("ul",[a("li",[t._v(" 每張健保卡每周可購買 "),a("strong",[t._v("2片")]),t._v("口罩 ")]),a("li",[t._v(" 身分證字號末碼 "),a("strong",[t._v("雙號")]),t._v("者可於每週 "),a("strong",[t._v("二、四、六")]),t._v("購買， "),a("strong",[t._v("單")]),t._v("號者可於每週一、三、五購買，週日則不限定身分證字號，開放全民皆可購買。(0為雙號) ")]),a("li",[t._v("兒童口罩僅限12歲以下(民國97年[含]後出生者，不分月、日)兒童健保卡購買，13歲以上健保卡僅能購買成人型口罩。")]),a("li",[t._v("每人每次限代持一張健保卡受託依時間規定購買")])]),a("a",{attrs:{href:"https://www.cdc.gov.tw/Bulletin/Detail/wycLegOplsUwGsH6_SPAXg?typeid=9"}},[t._v("資料來源：衛生福利部疾病管制署")]),a("h6",[t._v("圖示說明")]),a("ul",{staticClass:"infoBar"},[a("li",{staticClass:"text-dark"},[a("i",{staticClass:"fas fa-male"}),t._v(" ：成人 ")]),a("li",{staticClass:"text-dark"},[a("i",{staticClass:"fas fa-child"}),t._v(" ：兒童 ")]),a("li",{staticClass:"bg-light rounded"},[t._v("售完")]),a("li",{staticClass:"bg-warning rounded"},[t._v("存貨小於50")]),a("li",{staticClass:"bg-primary rounded"},[t._v("存貨充足")])])])])])])}],o=(a("99af"),a("4de4"),a("4160"),a("caad"),a("a15b"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("5530")),n=a("1157"),l=a.n(n),c=a("e11e"),d=a.n(c),u={name:"App",data:function(){return{osmMap:{},data:[],select:{city:"",county:""},allArea:[],stores:[],user:{userStat:!1,coords:[]},iconConfig:{shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},note:""}},methods:{createMap:function(){var t=this;t.osmMap=d.a.map("map",{center:[25.03,121.55],zoom:15}),d.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'<a target="_blank" href="https://www.openstreetmap.org/">© OpenStreetMap 貢獻者</a>',maxZoom:18}).addTo(t.osmMap)},getArea:function(){var t=this;this.$http.get("cityName.json").then((function(e){e.data.forEach((function(t){var e=t.CityName.split("");"臺"===e[0]&&(e[0]="台");var a=e.join("");t.CityName=a})),t.allArea=e.data}))},flyToUser:function(){var t=this;if(!0===t.user.userStat){t.removeMarkers(),t.select.city="",t.select.county="",t.osmMap.flyTo([t.user.coords[1],t.user.coords[0]]);var e=new d.a.Icon(Object(o["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png"},this.iconConfig));new d.a.Marker([this.user.coords[1],this.user.coords[0]],{icon:e}).addTo(this.osmMap),t.getNearby()}else alert("請開啟位置!")},getNearby:function(){var t=this,e=t.data;e.forEach((function(e){var a=t.distanceCal(e.geometry.coordinates[1],e.geometry.coordinates[0],t.user.coords[1],t.user.coords[0]);e.distance=a}));var a=e.filter((function(t){return t.distance<1}));a.sort((function(t,e){return t.distance-e.distance})),t.addColor(a),t.stores=a,t.stores.forEach((function(e){t.setMarker(e,"green")}))},addColor:function(t){function e(t,e,a){switch(!0){case 0===e:t.adultClass["bg-light"]=!0;break;case 0<e&&e<=50:t.adultClass["bg-warning"]=!0;break;case e>50:t.adultClass["bg-primary"]=!0;break}switch(!0){case 0===a:t.childClass["bg-light"]=!0;break;case 0<a&&a<=50:t.childClass["bg-warning"]=!0;break;case a>50:t.childClass["bg-primary"]=!0;break}}t.forEach((function(t){t.adultClass={"bg-light":!1,"bg-warning":!1,"bg-primary":!1},t.childClass={"bg-light":!1,"bg-warning":!1,"bg-primary":!1},e(t,t.properties.mask_adult,t.properties.mask_child)}))},openModal:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(console.log("#".concat(t,"Modal")),l()("#".concat(t,"Modal")).modal("show"),e){if(!(e.properties.note.length>2))return;this.note=e.properties.note}},setMarker:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"green",a=this,s=new d.a.Icon(Object(o["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-".concat(e,".png")},a.iconConfig));new d.a.Marker([t.geometry.coordinates[1],t.geometry.coordinates[0]],{icon:s}).addTo(a.osmMap).bindPopup("<strong>".concat(t.properties.name,'</strong><br>\n        <a href="https://www.google.com.tw/maps/place/').concat(t.properties.address,'" target="_blank">').concat(t.properties.address,"</a><br>\n        <p style='margin-top: 3px'>").concat(t.properties.phone,'</p><br>\n        <div class="d-flex">\n              <div class="rounded-left" >\n                <p style=\'font-size:25px\'><i style=\'margin-right:5px\' class="fas fa-male"></i>').concat(t.properties.mask_adult,"</p>\n              </div>\n              <div class=\"ml-4 rounded-right\">\n                <p  style='font-size:20px; line-height:39px'><i style='margin-right:5px' class=\"fas fa-child\"></i>").concat(t.properties.mask_child,"</link>\n              </div>\n            </div>\n        "))},removeMarkers:function(){var t=this;t.osmMap.eachLayer((function(e){e instanceof d.a.Marker&&t.osmMap.removeLayer(e)}))},flyTo:function(t,e){var a=this;a.osmMap.flyTo([t[1],t[0]]),a.osmMap.eachLayer((function(t){t._latlng&&t._latlng.lat===e.geometry.coordinates[1]&&t._latlng.lng===e.geometry.coordinates[0]&&t.openPopup()}));var s=screen.width;s<376&&l()("html, body").animate({scrollTop:l()("#map").offset().top},800)},updateMap:function(){var t=this;if(t.removeMarkers(),t.getStores(),t.stores.forEach((function(e){t.setMarker(e,"green")})),t.stores.length){t.flyTo(t.stores[0].geometry.coordinates,t.stores[0]);var e=[];t.osmMap.eachLayer((function(t){e.push(t)})),e[1].openPopup()}},getStores:function(){var t=this,e=t.data.filter((function(e){return e.properties.address.includes(t.select.city)})),a=e.filter((function(e){return e.properties.address.includes(t.select.county)}));t.addColor(a),t.stores=a},distanceCal:function(t,e,a,s){return 12756.274*Math.asin(Math.sqrt(Math.pow(Math.sin(Math.PI*(e-s)/360),2)+Math.cos(Math.PI*e/180)*Math.cos(Math.PI*s/180)*Math.pow(Math.sin(Math.PI*(t-a)/360),2)))}},mounted:function(){var t=this;this.createMap(),this.getArea();var e=function(){return new Promise((function(e,a){"geolocation"in navigator?navigator.geolocation.getCurrentPosition((function(a){var s=a.coords.longitude,r=a.coords.latitude;e([s,r]),t.user.userStat=!0})):t.user.userStat=!1}))};this.$http.get("https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json").then((function(e){t.data=e.data.features})).then(e).then((function(e){t.user.coords=e,t.flyToUser(),t.getNearby()}))}},p=u,f=(a("5c0b"),a("2877")),m=Object(f["a"])(p,r,i,!1,null,null,null),h=m.exports,v=a("bc3a"),g=a.n(v),_=a("a7fe"),y=a.n(_);a("4989");s["a"].use(y.a,g.a),s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(h)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var s=a("9c0c"),r=a.n(s);r.a},"9c0c":function(t,e,a){}});
//# sourceMappingURL=app.44ac5cbc.js.map